---
phase: 07-enhanced-ux-and-power-features
plan: 06
type: execute
wave: 2
depends_on: ["07-02"]
files_modified:
  - src/app/(platform)/assets/[id]/components/OverviewTab.tsx
  - src/app/(platform)/contributors/[id]/components/ProfileTab.tsx
  - src/app/(platform)/payees/[id]/components/ProfileTab.tsx
  - src/app/(platform)/users/[id]/components/ProfileTab.tsx
  - src/app/(platform)/assets/components/AssetTable.tsx
  - src/app/(platform)/contributors/components/ContributorTable.tsx
  - src/app/(platform)/payees/components/PayeeTable.tsx
  - src/app/(platform)/users/components/UserTable.tsx
autonomous: true

must_haves:
  truths:
    - "Clicking a field value on a detail page enters inline edit mode"
    - "Clicking a field value in a table row enters inline edit mode"
    - "Enter saves the edit via PATCH API call"
    - "Escape cancels the edit and restores original value"
    - "Successful save shows toast and updates displayed value"
    - "Failed save shows error toast and reverts"
    - "Asset inline edits: title, description, genre"
    - "Contributor inline edits: name, email, phone"
    - "Payee inline edits: name, email, paymentMethod"
    - "User inline edits: display name, username"
  artifacts:
    - path: "src/app/(platform)/assets/[id]/components/OverviewTab.tsx"
      provides: "Asset detail with inline editing on title, description, genre"
      contains: "InlineEditField"
    - path: "src/app/(platform)/users/[id]/components/ProfileTab.tsx"
      provides: "User detail with inline editing on name, username"
      contains: "InlineEditField"
    - path: "src/app/(platform)/assets/components/AssetTable.tsx"
      provides: "Asset table with inline editable title column"
      contains: "InlineEditField"
    - path: "src/app/(platform)/users/components/UserTable.tsx"
      provides: "User table with inline editable name column"
      contains: "InlineEditField"
  key_links:
    - from: "InlineEditField instances"
      to: "PATCH API routes"
      via: "onSave prop calling apiClient.patch"
      pattern: "apiClient\\.patch"
    - from: "InlineEditField instances"
      to: "@tanstack/react-query"
      via: "queryKey for cache invalidation"
      pattern: "queryKey"
---

<objective>
Integrate InlineEditField into detail pages and table rows for all four entity types.

Purpose: Staff can quickly edit common fields without navigating to full edit forms. This matches the Linear/Notion click-to-edit pattern specified in the CONTEXT decisions: click the value, it becomes an input, Enter saves, Escape cancels.

Output: Inline editing works on detail pages AND table rows for assets, contributors, payees, and users.
</objective>

<execution_context>
@/Users/sambeevors/.claude/get-shit-done/workflows/execute-plan.md
@/Users/sambeevors/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/07-enhanced-ux-and-power-features/07-CONTEXT.md
@.planning/phases/07-enhanced-ux-and-power-features/07-RESEARCH.md

@.planning/phases/07-enhanced-ux-and-power-features/07-02-SUMMARY.md

@src/components/inline-editing/InlineEditField.tsx
@src/app/(platform)/assets/[id]/components/OverviewTab.tsx
@src/app/(platform)/contributors/[id]/components/ProfileTab.tsx
@src/app/(platform)/payees/[id]/components/ProfileTab.tsx
@src/app/(platform)/users/[id]/components/ProfileTab.tsx
@src/app/(platform)/assets/components/AssetTable.tsx
@src/app/(platform)/contributors/components/ContributorTable.tsx
@src/app/(platform)/payees/components/PayeeTable.tsx
@src/app/(platform)/users/components/UserTable.tsx
@src/lib/api/client.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add inline editing to entity detail pages</name>
  <files>src/app/(platform)/assets/[id]/components/OverviewTab.tsx, src/app/(platform)/contributors/[id]/components/ProfileTab.tsx, src/app/(platform)/payees/[id]/components/ProfileTab.tsx, src/app/(platform)/users/[id]/components/ProfileTab.tsx</files>
  <action>
  Integrate InlineEditField into the detail page tabs for each entity type. Replace static text displays with InlineEditField for the specified fields.

  **Assets (OverviewTab or equivalent):**
  - title: Replace static `<span>` or `<p>` with `<InlineEditField value={asset.title} onSave={(v) => apiClient.patch('/api/assets/' + asset.id, { title: v })} queryKey={['asset', asset.id]} />`
  - description: Same pattern. May need a textarea variant — if InlineEditField only supports single-line input, use it for now and the value will truncate. Or if description is multi-line, consider using a wider input.
  - genre: Same inline edit pattern.
  - Do NOT make status, workflow state, or platform editable inline — these are controlled by workflow actions.

  **Contributors (ProfileTab):**
  - name: InlineEditField with onSave calling PATCH /api/contributors/{id}
  - email: InlineEditField with onSave calling PATCH /api/contributors/{id}
  - phone: InlineEditField with onSave calling PATCH /api/contributors/{id}

  **Payees (ProfileTab or detail component):**
  - name: InlineEditField with onSave calling PATCH /api/payees/{id}
  - email: InlineEditField with onSave calling PATCH /api/payees/{id}
  - paymentMethod: InlineEditField with onSave calling PATCH /api/payees/{id}

  **Users (ProfileTab):**
  - name (display name): InlineEditField with onSave calling PATCH /api/users/{id}
  - username: InlineEditField with onSave calling PATCH /api/users/{id}
  - Do NOT make email or status editable inline — security-sensitive per RESEARCH.

  For all: import `apiClient` from `@/lib/api/client` and use `apiClient.patch(url, body)` in the onSave handlers. Pass the appropriate queryKey for cache invalidation (e.g., `['user', userId]`, `['asset', assetId]`).

  If the detail page is a server component, the inline editing fields must be in a client sub-component. Check each page — if the tab is already a client component ('use client'), add InlineEditField directly. If it's a server component, extract the editable fields into a small client component.
  </action>
  <verify>
  Navigate to an asset detail page — title, description, genre are click-to-edit.
  Navigate to a contributor detail page — name, email, phone are click-to-edit.
  Navigate to a payee detail page — name, email, paymentMethod are click-to-edit.
  Navigate to a user detail page — display name, username are click-to-edit.
  Enter saves, Escape cancels, toast appears on save.
  </verify>
  <done>All four entity detail pages have inline editing on the specified fields. Click-to-edit, Enter-to-save, Escape-to-cancel behavior works with PATCH API calls and cache invalidation.</done>
</task>

<task type="auto">
  <name>Task 2: Add inline editing to table rows</name>
  <files>src/app/(platform)/assets/components/AssetTable.tsx, src/app/(platform)/contributors/components/ContributorTable.tsx, src/app/(platform)/payees/components/PayeeTable.tsx, src/app/(platform)/users/components/UserTable.tsx</files>
  <action>
  Integrate InlineEditField into table cell renderers for the most frequently edited field per entity. Table row inline editing should be limited to 1-2 key fields to avoid cluttered UX.

  **Per entity, make these table columns inline-editable:**
  - **AssetTable:** title column — replace the static text cell with InlineEditField. Keep the click handler for row navigation on OTHER columns, but on the title cell clicking should enter edit mode (NOT navigate). You may need to stop event propagation on the InlineEditField click.
  - **ContributorTable:** name column — same pattern.
  - **PayeeTable:** name column — same pattern.
  - **UserTable:** name column — same pattern.

  Important considerations for table rows:
  1. **Event propagation:** Table rows likely have an onClick handler for navigation. The InlineEditField's click must `e.stopPropagation()` to prevent row click from navigating. Add this to the InlineEditField's idle-state span click handler, or wrap the InlineEditField in a div that stops propagation.
  2. **Fixed row height:** Tables use 52px or 72px fixed row height for virtualization. The InlineEditField input must fit within this height — use text-sm, py-0.5, compact styling. If the InlineEditField was designed with detail page spacing, it may need a `compact` prop or the className override to reduce padding.
  3. **Column width:** The inline edit input should respect the column width. Use `w-full` on the input.
  4. **Keyboard navigation conflict:** Tables have j/k keyboard shortcuts. When InlineEditField is in edit mode, keyboard events should NOT trigger table navigation. The input captures focus, which should naturally prevent this — but verify.

  For the onSave handler, use `apiClient.patch('/api/{entity}/{row.id}', { fieldName: newValue })`. For queryKey, use the list query key (e.g., `['users', filterParams]`) to invalidate the list data after save.
  </action>
  <verify>
  In the Assets list, click on an asset title in the table — it enters edit mode, NOT navigating to detail page.
  Press Enter — saves and updates.
  Press Escape — cancels and shows original.
  Same behavior for Contributors, Payees, Users name columns.
  Row navigation still works when clicking other columns.
  Virtualization still works (no broken layout from edit mode).
  </verify>
  <done>Table rows support inline editing on key columns (title for assets, name for others). Event propagation handled correctly — inline edit click does not trigger row navigation. Edit mode input fits within fixed row height.</done>
</task>

</tasks>

<verification>
1. Asset detail: title, description, genre are inline editable
2. Contributor detail: name, email, phone are inline editable
3. Payee detail: name, email, paymentMethod are inline editable
4. User detail: display name, username are inline editable
5. Asset table: title column is inline editable
6. Contributor table: name column is inline editable
7. Payee table: name column is inline editable
8. User table: name column is inline editable
9. Enter saves with toast, Escape cancels, no save on blur
10. Table row navigation still works on non-editable columns
11. Virtualized table layout is not broken by edit mode
</verification>

<success_criteria>
- Inline editing works on both detail pages and table rows for all 4 entity types
- Click activates edit mode, Enter saves, Escape cancels
- PATCH API calls succeed and cache is invalidated
- Table event propagation is handled (inline edit vs row navigation)
- No layout breakage in virtualized tables
</success_criteria>

<output>
After completion, create `.planning/phases/07-enhanced-ux-and-power-features/07-06-SUMMARY.md`
</output>
