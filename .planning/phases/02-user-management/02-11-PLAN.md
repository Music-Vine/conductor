---
phase: 02-user-management
plan: 11
type: execute
wave: 5
depends_on: ["02-09", "02-10"]
files_modified: []
autonomous: false

must_haves:
  truths:
    - "All Phase 2 success criteria verified by human"
    - "User search and filtering works"
    - "User detail tabs display correctly"
    - "Account actions function properly"
    - "CSV export produces valid file"
---

<objective>
Human verification checkpoint for Phase 2 User Management functionality.

Purpose: Verify all user management features work correctly through manual testing before phase completion.

Output: Verified Phase 2 complete or issue list for gap closure.
</objective>

<execution_context>
@/Users/sambeevors/.claude/get-shit-done/workflows/execute-plan.md
@/Users/sambeevors/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/02-user-management/02-CONTEXT.md
</context>

<tasks>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
Complete User Management system including:
- User list with search, filtering, and pagination
- User detail view with tabbed sections (Profile, Subscription, Downloads)
- Account actions (Suspend/Unsuspend, Disconnect OAuth, Issue Refund)
- CSV export functionality
- Row-level quick actions
  </what-built>
  <how-to-verify>
Start the dev server: `npm run dev`

**Test 1: User List and Search**
1. Navigate to http://localhost:3000/users
2. Verify table shows mock users with columns: User, Status, Subscription, Last Login, Actions
3. Type a search term, click Search button
4. Verify URL updates with ?query=... and results filter
5. Change Status filter to "Suspended"
6. Verify URL updates and only suspended users show
7. Change Subscription filter to "Pro"
8. Verify combined filters work

**Test 2: Pagination**
1. Verify pagination shows "Showing X-Y of Z users"
2. Click Next page
3. Verify URL shows ?page=2 and table updates
4. Click Previous
5. Verify back to page 1

**Test 3: User Detail - Profile Tab**
1. Click any user row
2. Verify navigation to /users/[id]
3. Verify user header shows name, email, status
4. Verify Profile tab shows:
   - Identity info (email, name, username, ID, platform)
   - Account status
   - OAuth connections (if any)
5. Verify tabs switch when clicked

**Test 4: User Detail - Subscription Tab**
1. Click Subscription tab
2. Verify URL updates to ?tab=subscription
3. Verify shows:
   - Current plan details
   - Entitlements list
   - Billing history
4. For non-free users, verify "Issue Refund" button visible

**Test 5: User Detail - Downloads Tab**
1. Click "Downloads + Licenses" tab
2. Verify URL updates to ?tab=downloads
3. Verify timeline shows mixed downloads and licenses
4. Verify date grouping (Today, Yesterday, etc.)
5. Click "Load more" if available

**Test 6: Account Actions - Suspend**
1. On Profile tab, find active user
2. Click "Suspend Account" button
3. Verify confirmation dialog appears
4. Confirm suspend
5. Verify toast shows success
6. Verify status changes to "Suspended"
7. Verify "Unsuspend Account" button now visible

**Test 7: Account Actions - Unsuspend**
1. On suspended user, click "Unsuspend Account"
2. Confirm in dialog
3. Verify status changes back to "Active"

**Test 8: Disconnect OAuth**
1. Find user with OAuth connections
2. Click "Disconnect" on a connection
3. Verify confirmation dialog
4. Confirm disconnect
5. Verify toast and connection removed

**Test 9: Issue Refund**
1. On non-free user, click "Issue Refund"
2. Verify confirmation dialog with Stripe note
3. Confirm refund
4. Verify toast shows "Refund initiated"

**Test 10: Row Actions**
1. Return to user list (/users)
2. Click three-dot menu on any row
3. Verify dropdown shows: View Details, Suspend/Unsuspend
4. Click "View Details" - navigates to detail
5. Go back, click Suspend from dropdown
6. Verify dialog appears

**Test 11: CSV Export**
1. On /users page, click "Export CSV"
2. Verify CSV file downloads
3. Open CSV - verify headers and data match displayed users
4. Apply a filter, export again
5. Verify exported data matches filtered results

**Test 12: Loading States**
1. Hard refresh /users - verify skeleton appears
2. Hard refresh /users/[id] - verify skeleton appears
3. Navigate between pages - verify loading indicators
  </how-to-verify>
  <resume-signal>
Type "approved" if all tests pass.
Or describe any issues found (e.g., "Test 6 failed: suspend button missing on Profile tab")
  </resume-signal>
</task>

</tasks>

<verification>
Human has manually verified all functionality.
</verification>

<success_criteria>
All 12 test scenarios pass without issues.
</success_criteria>

<output>
After completion, create `.planning/phases/02-user-management/02-11-SUMMARY.md`

If issues found, create gap closure plan(s) to address them.
</output>
