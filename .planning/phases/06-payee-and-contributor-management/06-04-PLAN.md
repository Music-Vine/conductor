---
phase: 06-payee-and-contributor-management
plan: 04
type: execute
wave: 3
depends_on: ["06-03"]
files_modified:
  - src/app/(platform)/contributors/[id]/page.tsx
  - src/app/(platform)/contributors/[id]/loading.tsx
  - src/app/(platform)/contributors/[id]/components/ContributorDetailTabs.tsx
  - src/app/(platform)/contributors/[id]/components/ProfileTab.tsx
  - src/app/(platform)/contributors/[id]/components/PayeesTab.tsx
  - src/app/(platform)/contributors/[id]/components/AssetsTab.tsx
  - src/app/(platform)/contributors/[id]/components/index.ts
autonomous: true

must_haves:
  truths:
    - "Staff can view contributor profile information (name, email, phone, tax ID, address, status)"
    - "Staff can view assigned payees with percentage rates in a table"
    - "Staff can see total payout rate summary (100% = green, <100% = yellow, >100% = red)"
    - "Staff can view contributor's associated assets"
    - "Tabs persist via URL search params for shareable links"
  artifacts:
    - path: "src/app/(platform)/contributors/[id]/page.tsx"
      provides: "Contributor detail page with server-side data fetching"
      contains: "fetchContributor"
    - path: "src/app/(platform)/contributors/[id]/components/PayeesTab.tsx"
      provides: "Payee relationships table with percentage rate display"
      contains: "percentageRate"
    - path: "src/app/(platform)/contributors/[id]/components/ProfileTab.tsx"
      provides: "Contributor profile information display"
      contains: "ProfileTab"
  key_links:
    - from: "src/app/(platform)/contributors/[id]/page.tsx"
      to: "src/lib/api/contributors.ts"
      via: "fetchContributor, fetchContributorPayees, fetchContributorAssets"
      pattern: "fetchContributor"
    - from: "src/app/(platform)/contributors/[id]/components/PayeesTab.tsx"
      to: "/api/contributors/[id]/payees"
      via: "data from page server fetch"
      pattern: "percentageRate"
---

<objective>
Create the contributor detail page with tabbed interface showing profile info, payee relationships, and associated assets.

Purpose: Enable staff to view complete contributor information including financial relationships (PAYE-01, PAYE-04). The payees tab shows assigned payees with percentage rates and a total rate summary.
Output: Working contributor detail page at /contributors/[id] with Profile, Payees, and Assets tabs.
</objective>

<execution_context>
@/Users/sambeevors/.claude/get-shit-done/workflows/execute-plan.md
@/Users/sambeevors/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@src/app/(platform)/users/[id]/page.tsx
@src/app/(platform)/users/[id]/components/UserDetailTabs.tsx
@src/app/(platform)/users/[id]/components/ProfileTab.tsx
@src/lib/api/contributors.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create contributor detail page and tab structure</name>
  <files>src/app/(platform)/contributors/[id]/page.tsx, src/app/(platform)/contributors/[id]/loading.tsx, src/app/(platform)/contributors/[id]/components/ContributorDetailTabs.tsx, src/app/(platform)/contributors/[id]/components/ProfileTab.tsx, src/app/(platform)/contributors/[id]/components/index.ts</files>
  <action>
Follow the user detail page pattern (src/app/(platform)/users/[id]/) exactly.

**page.tsx:** Server component
- Use Next.js 15 async params: `{ params }: { params: Promise<{ id: string }> }`
- Fetch contributor detail, payees, and assets in parallel using Promise.all
- Call fetchContributor(id), fetchContributorPayees(id), fetchContributorAssets(id)
- Render page header with contributor name, status badge, and "Back to Contributors" link
- Pass all data to ContributorDetailTabs

**loading.tsx:** Loading skeleton similar to users/[id]/loading.tsx

**ContributorDetailTabs.tsx:** Client component with Radix Tabs
- Tabs: Profile, Payees, Assets
- Tab state synced to URL search params (tab=profile, tab=payees, tab=assets)
- Default tab: profile
- Follow UserDetailTabs.tsx pattern exactly for Radix Tabs setup

**ProfileTab.tsx:** Display contributor information in a card layout
- Section 1: Contact Info - Name, Email, Phone, Tax ID (masked: show last 4 digits only, e.g., "***-**-1234")
- Section 2: Address - Full address if available, "No address on file" if not
- Section 3: Account Info - Status badge, Created date, Updated date
- Section 4: Summary Stats - Total Assets count, Total Payees count
- Use info rows pattern (label: value pairs) like Phase 2 ProfileTab
- Status badge colors: active=green, inactive=red, pending=yellow

**index.ts:** Barrel export for all tab components.
  </action>
  <verify>Run `npx tsc --noEmit`. Visit /contributors/contrib-001 and verify profile tab shows contributor information with masked tax ID.</verify>
  <done>Contributor detail page loads with profile information, tabbed navigation synced to URL params, status badges, and masked sensitive data.</done>
</task>

<task type="auto">
  <name>Task 2: Create PayeesTab and AssetsTab components</name>
  <files>src/app/(platform)/contributors/[id]/components/PayeesTab.tsx, src/app/(platform)/contributors/[id]/components/AssetsTab.tsx</files>
  <action>
**PayeesTab.tsx:** Display payee relationships with percentage rates
- Summary card at top showing total payout rate:
  - Total percentage with color coding: 100% = green (text-green-600), <100% = yellow (text-yellow-600), >100% = red (text-red-600)
  - If not 100%, show "X% unassigned" or "X% over allocated"
  - Background: border border-gray-200 rounded-lg bg-gray-50 p-4
- Relationships table using TanStack Table (getCoreRowModel only, no pagination needed - max ~5 payees per contributor):
  - Columns: Payee Name (with email subtitle), Rate (large font, e.g., "70%"), Effective Date (formatted), Payment Method (badge: uppercase, bg-gray-100), Actions (Edit Rate button, Remove button)
  - Edit Rate button: variant="subtle" size="sm" - for now just shows a toast "Edit rate functionality coming in Plan 06"
  - Remove button: variant="error" size="sm" - for now shows a toast placeholder
- "Add Payee" button at bottom: variant="bold" - for now toast placeholder "Add payee functionality coming in Plan 06"
- Empty state if no payees assigned: Use EmptyState component with message "No payees assigned" and "Assign Payee" action button

**AssetsTab.tsx:** Display contributor's assets
- Simple table showing contributor's assets
- Columns: Title, Type (badge with asset type color coding from Phase 4), Status, Created
- Row click navigates to /assets/[assetId]
- Empty state if no assets: "No assets found for this contributor"
- No pagination needed (max 15 assets per contributor in mock data)
  </action>
  <verify>Run `npx tsc --noEmit`. Visit /contributors/contrib-001, click Payees tab - verify rate summary shows 100% in green. Click Assets tab - verify asset list displays.</verify>
  <done>PayeesTab shows assigned payees with rates summing to 100% (green), rate summary card, and per-payee details. AssetsTab shows contributor's assets with type badges.</done>
</task>

</tasks>

<verification>
1. `npx tsc --noEmit` passes
2. /contributors/contrib-001 loads with profile information
3. Profile tab shows masked tax ID (***-**-XXXX format)
4. Payees tab shows payee table with rates and total summary
5. Total rate shows green when 100%, yellow when under, red when over
6. Assets tab shows contributor's assets
7. Tab state persists in URL (tab=payees in URL shows payees tab)
</verification>

<success_criteria>
- Contributor detail page shows all profile fields with proper formatting
- Payees tab displays rate allocation with visual feedback on total percentage
- Assets tab links to asset detail pages
- All tabs work with URL-based state persistence
</success_criteria>

<output>
After completion, create `.planning/phases/06-payee-and-contributor-management/06-04-SUMMARY.md`
</output>
