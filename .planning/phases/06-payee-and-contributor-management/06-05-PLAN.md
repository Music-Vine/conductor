---
phase: 06-payee-and-contributor-management
plan: 05
type: execute
wave: 3
depends_on: ["06-03"]
files_modified:
  - src/app/(platform)/payees/page.tsx
  - src/app/(platform)/payees/loading.tsx
  - src/app/(platform)/payees/components/PayeeTable.tsx
  - src/app/(platform)/payees/components/PayeeFilters.tsx
  - src/app/(platform)/payees/components/index.ts
  - src/app/(platform)/payees/[id]/page.tsx
  - src/app/(platform)/payees/[id]/loading.tsx
  - src/app/(platform)/payees/[id]/components/PayeeDetailTabs.tsx
  - src/app/(platform)/payees/[id]/components/PayeeProfileTab.tsx
  - src/app/(platform)/payees/[id]/components/PayeeContributorsTab.tsx
  - src/app/(platform)/payees/[id]/components/index.ts
autonomous: true

must_haves:
  truths:
    - "Staff can view a paginated list of payees with name, email, payment method, status, and contributor count"
    - "Staff can search payees by name or email"
    - "Staff can filter payees by status and payment method"
    - "Staff can view payee detail with profile information and payment details"
    - "Staff can see which contributors are associated with a payee"
  artifacts:
    - path: "src/app/(platform)/payees/page.tsx"
      provides: "Payee list page with search, filters, and table"
      contains: "PayeeFilters"
    - path: "src/app/(platform)/payees/[id]/page.tsx"
      provides: "Payee detail page with tabs"
      contains: "fetchPayee"
    - path: "src/app/(platform)/payees/[id]/components/PayeeContributorsTab.tsx"
      provides: "Reverse lookup showing contributors for a payee"
      contains: "contributor"
  key_links:
    - from: "src/app/(platform)/payees/page.tsx"
      to: "src/lib/api/payees.ts"
      via: "server-side fetch"
      pattern: "fetchPayees"
    - from: "src/app/(platform)/payees/[id]/page.tsx"
      to: "src/lib/api/payees.ts"
      via: "fetchPayee, fetchPayeeContributors"
      pattern: "fetchPayee"
---

<objective>
Create the payee list page and payee detail page with profile and contributors tabs.

Purpose: Enable staff to browse, search, and view payee information including which contributors they receive payments for (PAYE-04). Payees are the financial recipients in the contributor-payee relationship.
Output: Working payee list page at /payees and detail page at /payees/[id] with Profile and Contributors tabs.
</objective>

<execution_context>
@/Users/sambeevors/.claude/get-shit-done/workflows/execute-plan.md
@/Users/sambeevors/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@src/app/(platform)/users/page.tsx
@src/app/(platform)/users/[id]/page.tsx
@src/app/(platform)/contributors/page.tsx
@src/app/(platform)/contributors/[id]/page.tsx
@src/lib/api/payees.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create payee list page with table and filters</name>
  <files>src/app/(platform)/payees/page.tsx, src/app/(platform)/payees/loading.tsx, src/app/(platform)/payees/components/PayeeTable.tsx, src/app/(platform)/payees/components/PayeeFilters.tsx, src/app/(platform)/payees/components/index.ts</files>
  <action>
Create payee list page following the same patterns as the contributor list page (Plan 03) and users page (Phase 2).

**PayeeFilters.tsx:** Client component
- Search input with Search button (button-triggered)
- Status dropdown: All Statuses, Active, Inactive
- Payment Method dropdown: All Methods, ACH, Wire, Check, PayPal
- URL-based state management, page resets to 1 on filter change
- Same styling as ContributorFilters/UserFilters

**PayeeTable.tsx:** Client component with TanStack Table
- Columns: Name (with email subtitle), Payment Method (badge: uppercase, color-coded per method - ACH=blue, Wire=purple, Check=gray, PayPal=indigo), Status (badge: active=green, inactive=red), Contributors (count), Created (date)
- Row click navigates to /payees/[id]
- Pagination at bottom
- Same row height and virtualization pattern as other tables

**page.tsx:** Server component
- Accept searchParams promise (Next.js 15 async pattern)
- Parse query, status, paymentMethod, page params
- Call fetchPayees server-side
- Page header: "Payees" with subtitle "Manage payment recipients and financial details"
- "Add Payee" button in header area, links to /payees/new (created in later plan)
- Render PayeeFilters, then PayeeTable

**loading.tsx:** Skeleton loading state

**components/index.ts:** Barrel exports
  </action>
  <verify>Run `npx tsc --noEmit`. Visit /payees page and verify table shows 10 payees with search, status filter, and payment method filter working.</verify>
  <done>Payee list page shows paginated table with search, status and payment method filters, and row navigation to detail.</done>
</task>

<task type="auto">
  <name>Task 2: Create payee detail page with profile and contributors tabs</name>
  <files>src/app/(platform)/payees/[id]/page.tsx, src/app/(platform)/payees/[id]/loading.tsx, src/app/(platform)/payees/[id]/components/PayeeDetailTabs.tsx, src/app/(platform)/payees/[id]/components/PayeeProfileTab.tsx, src/app/(platform)/payees/[id]/components/PayeeContributorsTab.tsx, src/app/(platform)/payees/[id]/components/index.ts</files>
  <action>
Create payee detail page following contributor detail (Plan 04) and user detail (Phase 2) patterns.

**page.tsx:** Server component
- Fetch payee detail and associated contributors in parallel
- Call fetchPayee(id) and fetchPayeeContributors(id)
- Page header with payee name, status badge, "Back to Payees" link
- Pass data to PayeeDetailTabs

**PayeeDetailTabs.tsx:** Client component with Radix Tabs
- Tabs: Profile, Contributors
- URL-synced tab state (tab=profile, tab=contributors)
- Default tab: profile

**PayeeProfileTab.tsx:** Display payee information
- Section 1: Contact Info - Name, Email, Phone
- Section 2: Payment Details - Payment Method (badge), Account Number (masked: show last 4), Routing Number (masked), PayPal Email (if applicable)
- Section 3: Tax Info - Tax ID (masked: last 4 only)
- Section 4: Address - Full address or "No address on file"
- Section 5: Account Info - Status, Created, Updated dates
- Mask sensitive data: accountNumber shows "****1234", routingNumber shows "****5678"

**PayeeContributorsTab.tsx:** Reverse lookup showing contributors
- Table using TanStack Table (getCoreRowModel):
  - Columns: Contributor Name, Percentage Rate (large font), Effective Date, Actions (View Contributor button)
  - View Contributor button navigates to /contributors/[contributorId]
- Summary showing total number of contributors
- Empty state: "No contributors associated with this payee"

**loading.tsx:** Loading skeleton
**index.ts:** Barrel exports
  </action>
  <verify>Run `npx tsc --noEmit`. Visit /payees/payee-001. Verify Profile tab shows masked payment details. Click Contributors tab - verify associated contributors display with percentage rates.</verify>
  <done>Payee detail page shows profile with masked sensitive data, payment method details, and contributors tab showing reverse relationships.</done>
</task>

</tasks>

<verification>
1. `npx tsc --noEmit` passes
2. /payees page loads with 10 payees in table
3. Search, status filter, and payment method filter work correctly
4. /payees/payee-001 loads with profile information
5. Payment details are masked (last 4 digits only)
6. Contributors tab shows associated contributors with rates
7. "View Contributor" navigates to contributor detail page
</verification>

<success_criteria>
- Payee list page functional with all filters and pagination
- Payee detail shows masked sensitive financial data
- Contributors tab provides reverse relationship lookup
- All patterns consistent with contributor and user pages
</success_criteria>

<output>
After completion, create `.planning/phases/06-payee-and-contributor-management/06-05-SUMMARY.md`
</output>
