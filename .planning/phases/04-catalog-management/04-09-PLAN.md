---
phase: 04-catalog-management
plan: 09
type: execute
wave: 4
depends_on: ["04-01", "04-03"]
files_modified:
  - src/app/(platform)/assets/[id]/page.tsx
  - src/app/(platform)/assets/[id]/loading.tsx
  - src/app/(platform)/assets/[id]/components/AssetDetailTabs.tsx
  - src/app/(platform)/assets/[id]/components/OverviewTab.tsx
  - src/app/(platform)/assets/[id]/components/index.ts
autonomous: true

must_haves:
  truths:
    - "Asset detail page loads asset data with tabs"
    - "Overview tab shows metadata, preview placeholder, and platform"
    - "Tab navigation persists in URL"
  artifacts:
    - path: "src/app/(platform)/assets/[id]/page.tsx"
      provides: "Asset detail page"
      exports: ["default"]
    - path: "src/app/(platform)/assets/[id]/components/AssetDetailTabs.tsx"
      provides: "Tab container with URL sync"
      exports: ["AssetDetailTabs"]
    - path: "src/app/(platform)/assets/[id]/components/OverviewTab.tsx"
      provides: "Asset metadata display"
      exports: ["OverviewTab"]
  key_links:
    - from: "src/app/(platform)/assets/[id]/page.tsx"
      to: "src/lib/api/assets.ts"
      via: "getAsset fetch"
      pattern: "import.*getAsset"
---

<objective>
Build the asset detail page with tabbed interface for overview, workflow, collections, and activity.

Purpose: Staff can view complete asset information and manage individual assets.
Output: Asset detail page with overview tab following user detail page patterns.
</objective>

<execution_context>
@/Users/sambeevors/.claude/get-shit-done/workflows/execute-plan.md
@/Users/sambeevors/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-catalog-management/CONTEXT.md
@.planning/phases/04-catalog-management/04-01-SUMMARY.md
@.planning/phases/04-catalog-management/04-03-SUMMARY.md

# Existing patterns to follow
@src/app/(platform)/users/[id]/page.tsx
@src/app/(platform)/users/[id]/components/UserDetailTabs.tsx
@src/app/(platform)/users/[id]/components/ProfileTab.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create asset detail page structure</name>
  <files>src/app/(platform)/assets/[id]/page.tsx, src/app/(platform)/assets/[id]/loading.tsx</files>
  <action>
Create asset detail page following the user detail pattern:

src/app/(platform)/assets/[id]/page.tsx:
```typescript
import { notFound } from 'next/navigation'
import { getAsset } from '@/lib/api/assets'
import { AssetDetailTabs } from './components'

interface AssetDetailPageProps {
  params: Promise<{ id: string }>
  searchParams: Promise<{ tab?: string }>
}

export default async function AssetDetailPage({ params, searchParams }: AssetDetailPageProps) {
  const { id } = await params
  const { tab } = await searchParams

  const asset = await getAsset(id)

  if (!asset) {
    notFound()
  }

  return (
    <div className="space-y-6">
      {/* Header */}
      <div className="flex items-start justify-between">
        <div>
          <div className="flex items-center gap-3">
            <h1 className="text-2xl font-semibold text-gray-900">{asset.title}</h1>
            <AssetTypeBadge type={asset.type} />
            <WorkflowStatusBadge status={asset.status} />
          </div>
          <p className="mt-1 text-sm text-gray-600">
            Uploaded by {asset.contributorName} on {new Date(asset.createdAt).toLocaleDateString()}
          </p>
        </div>

        <div className="flex items-center gap-2">
          <PlatformBadge platform={asset.platform} />
        </div>
      </div>

      {/* Tabs */}
      <AssetDetailTabs asset={asset} currentTab={tab || 'overview'} />
    </div>
  )
}

function AssetTypeBadge({ type }: { type: string }) {
  const labels: Record<string, string> = {
    music: 'Music',
    sfx: 'SFX',
    'motion-graphics': 'Motion Graphics',
    lut: 'LUT',
    'stock-footage': 'Stock Footage',
  }
  const colors: Record<string, string> = {
    music: 'bg-purple-100 text-purple-800',
    sfx: 'bg-blue-100 text-blue-800',
    'motion-graphics': 'bg-green-100 text-green-800',
    lut: 'bg-yellow-100 text-yellow-800',
    'stock-footage': 'bg-orange-100 text-orange-800',
  }
  return (
    <span className={`inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium ${colors[type] || 'bg-gray-100 text-gray-800'}`}>
      {labels[type] || type}
    </span>
  )
}

function WorkflowStatusBadge({ status }: { status: string }) {
  // Import getStateLabel, getStateColor from workflow/states
  const label = getStateLabel(status)
  const color = getStateColor(status)
  return (
    <span className={`inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium ${color}`}>
      {label}
    </span>
  )
}

function PlatformBadge({ platform }: { platform: string }) {
  const config: Record<string, { label: string; color: string }> = {
    'music-vine': { label: 'Music Vine', color: 'bg-red-100 text-red-800' },
    'uppbeat': { label: 'Uppbeat', color: 'bg-pink-100 text-pink-800' },
    'both': { label: 'Both Platforms', color: 'bg-gray-100 text-gray-800' },
  }
  const { label, color } = config[platform] || { label: platform, color: 'bg-gray-100 text-gray-800' }
  return (
    <span className={`inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium ${color}`}>
      {label}
    </span>
  )
}
```

Create loading.tsx with skeletons for header and tabs.
  </action>
  <verify>Page renders at /assets/[id] with asset data</verify>
  <done>Asset detail page shows header with type, status, and platform badges</done>
</task>

<task type="auto">
  <name>Task 2: Create tabs component with URL sync</name>
  <files>src/app/(platform)/assets/[id]/components/AssetDetailTabs.tsx</files>
  <action>
Create AssetDetailTabs following UserDetailTabs pattern:

```typescript
'use client'

import { useRouter, useSearchParams } from 'next/navigation'
import * as Tabs from '@radix-ui/react-tabs'
import type { Asset } from '@/types/asset'
import { OverviewTab } from './OverviewTab'
import { WorkflowTab } from './WorkflowTab'
import { CollectionsTab } from './CollectionsTab'
import { ActivityTab } from './ActivityTab'

interface AssetDetailTabsProps {
  asset: Asset
  currentTab: string
}

export function AssetDetailTabs({ asset, currentTab }: AssetDetailTabsProps) {
  const router = useRouter()
  const searchParams = useSearchParams()

  const handleTabChange = (value: string) => {
    const params = new URLSearchParams(searchParams.toString())
    if (value === 'overview') {
      params.delete('tab')
    } else {
      params.set('tab', value)
    }
    const query = params.toString()
    router.push(`/assets/${asset.id}${query ? `?${query}` : ''}`)
  }

  const tabs = [
    { id: 'overview', label: 'Overview' },
    { id: 'workflow', label: 'Workflow' },
    { id: 'collections', label: 'Collections' },
    { id: 'activity', label: 'Activity' },
  ]

  return (
    <Tabs.Root value={currentTab} onValueChange={handleTabChange}>
      <Tabs.List className="flex border-b border-gray-200">
        {tabs.map((tab) => (
          <Tabs.Trigger
            key={tab.id}
            value={tab.id}
            className={`
              px-4 py-2 text-sm font-medium transition-colors border-b-2 -mb-px
              ${currentTab === tab.id
                ? 'border-platform-primary text-platform-primary'
                : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'
              }
            `}
          >
            {tab.label}
          </Tabs.Trigger>
        ))}
      </Tabs.List>

      <div className="mt-6">
        <Tabs.Content value="overview">
          <OverviewTab asset={asset} />
        </Tabs.Content>
        <Tabs.Content value="workflow">
          <WorkflowTab asset={asset} />
        </Tabs.Content>
        <Tabs.Content value="collections">
          <CollectionsTab asset={asset} />
        </Tabs.Content>
        <Tabs.Content value="activity">
          <ActivityTab asset={asset} />
        </Tabs.Content>
      </div>
    </Tabs.Root>
  )
}
```

Note: WorkflowTab, CollectionsTab, ActivityTab will be placeholder components for now, built in subsequent plans.
  </action>
  <verify>Tab switching updates URL and shows correct content</verify>
  <done>Tabs work with URL persistence, default is overview</done>
</task>

<task type="auto">
  <name>Task 3: Create overview tab with metadata display</name>
  <files>src/app/(platform)/assets/[id]/components/OverviewTab.tsx, src/app/(platform)/assets/[id]/components/index.ts</files>
  <action>
Create OverviewTab showing all asset metadata:

```typescript
'use client'

import type { Asset } from '@/types/asset'
import { isMusicAsset } from '@/types/asset'

interface OverviewTabProps {
  asset: Asset
}

export function OverviewTab({ asset }: OverviewTabProps) {
  return (
    <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
      {/* Preview section */}
      <div className="lg:col-span-2">
        <div className="bg-white rounded-lg border border-gray-200 p-6">
          <h2 className="text-lg font-medium text-gray-900 mb-4">Preview</h2>
          <AssetPreviewPlaceholder asset={asset} />
        </div>
      </div>

      {/* Metadata section */}
      <div className="space-y-6">
        {/* Basic Info */}
        <div className="bg-white rounded-lg border border-gray-200 p-6">
          <h2 className="text-lg font-medium text-gray-900 mb-4">Details</h2>
          <dl className="space-y-3">
            <MetadataRow label="Title" value={asset.title} />
            {asset.description && <MetadataRow label="Description" value={asset.description} />}
            <MetadataRow label="Contributor" value={asset.contributorName} />
            <MetadataRow label="Genre" value={asset.genre} />

            {/* Type-specific fields */}
            {isMusicAsset(asset) && (
              <>
                {asset.bpm && <MetadataRow label="BPM" value={String(asset.bpm)} />}
                {asset.key && <MetadataRow label="Key" value={asset.key} />}
                <MetadataRow label="Duration" value={formatDuration(asset.duration)} />
              </>
            )}

            {asset.type === 'sfx' && (
              <>
                <MetadataRow label="Category" value={(asset as any).category} />
                <MetadataRow label="Duration" value={formatDuration((asset as any).duration)} />
              </>
            )}

            {(asset.type === 'motion-graphics' || asset.type === 'stock-footage') && (
              <>
                <MetadataRow label="Resolution" value={(asset as any).resolution} />
                <MetadataRow label="Duration" value={formatDuration((asset as any).duration)} />
              </>
            )}

            {asset.type === 'lut' && (
              <>
                <MetadataRow label="Format" value={(asset as any).format} />
              </>
            )}
          </dl>
        </div>

        {/* Tags */}
        {asset.tags && asset.tags.length > 0 && (
          <div className="bg-white rounded-lg border border-gray-200 p-6">
            <h2 className="text-lg font-medium text-gray-900 mb-4">Tags</h2>
            <div className="flex flex-wrap gap-2">
              {asset.tags.map((tag, i) => (
                <span
                  key={i}
                  className="inline-flex items-center rounded-full bg-gray-100 px-2.5 py-0.5 text-xs font-medium text-gray-800"
                >
                  {tag}
                </span>
              ))}
            </div>
          </div>
        )}

        {/* Actions */}
        <div className="bg-white rounded-lg border border-gray-200 p-6">
          <h2 className="text-lg font-medium text-gray-900 mb-4">Actions</h2>
          <div className="space-y-3">
            <button className="w-full text-left px-3 py-2 rounded-lg text-sm text-gray-700 hover:bg-gray-50">
              Edit Metadata
            </button>
            {asset.status === 'published' && (
              <button className="w-full text-left px-3 py-2 rounded-lg text-sm text-red-600 hover:bg-red-50">
                Unpublish Asset
              </button>
            )}
          </div>
        </div>
      </div>
    </div>
  )
}

function MetadataRow({ label, value }: { label: string; value: string }) {
  return (
    <div className="flex justify-between">
      <dt className="text-sm text-gray-500">{label}</dt>
      <dd className="text-sm font-medium text-gray-900">{value}</dd>
    </div>
  )
}

function formatDuration(seconds: number): string {
  const mins = Math.floor(seconds / 60)
  const secs = Math.floor(seconds % 60)
  return `${mins}:${secs.toString().padStart(2, '0')}`
}

function AssetPreviewPlaceholder({ asset }: { asset: Asset }) {
  // Placeholder for now - WaveSurfer will be added in a later plan
  return (
    <div className="aspect-video bg-gray-100 rounded-lg flex items-center justify-center">
      <div className="text-center">
        <div className="text-4xl text-gray-400 mb-2">
          {asset.type === 'music' || asset.type === 'sfx' ? 'ðŸŽµ' : 'ðŸŽ¬'}
        </div>
        <p className="text-sm text-gray-500">Preview coming soon</p>
      </div>
    </div>
  )
}
```

Create placeholder components for WorkflowTab, CollectionsTab, ActivityTab:
```typescript
// WorkflowTab.tsx - placeholder
export function WorkflowTab({ asset }: { asset: Asset }) {
  return <div className="text-gray-500">Workflow tab coming soon</div>
}

// CollectionsTab.tsx - placeholder
export function CollectionsTab({ asset }: { asset: Asset }) {
  return <div className="text-gray-500">Collections tab coming soon</div>
}

// ActivityTab.tsx - placeholder
export function ActivityTab({ asset }: { asset: Asset }) {
  return <div className="text-gray-500">Activity tab coming soon</div>
}
```

Create index.ts to export all components.
  </action>
  <verify>Overview tab shows asset metadata with type-specific fields</verify>
  <done>Overview tab displays all metadata, tags, and action buttons</done>
</task>

</tasks>

<verification>
1. /assets/[id] loads asset data
2. Header shows title, type badge, status badge, platform badge
3. Tab navigation updates URL (?tab=workflow)
4. Overview tab shows correct metadata fields per asset type
5. Duration formatted as mm:ss
6. Tags displayed as badges
</verification>

<success_criteria>
- Asset detail page matches user detail page patterns
- Discriminated union type narrowing works for type-specific fields
- Tab persistence in URL enables direct linking
- Placeholder tabs ready for subsequent plans
</success_criteria>

<output>
After completion, create `.planning/phases/04-catalog-management/04-09-SUMMARY.md`
</output>
