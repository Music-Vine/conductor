---
phase: 04-catalog-management
plan: 07
type: execute
wave: 3
depends_on: ["04-01", "04-03"]
files_modified:
  - src/app/(platform)/assets/page.tsx
  - src/app/(platform)/assets/loading.tsx
  - src/app/(platform)/assets/components/AssetTable.tsx
  - src/app/(platform)/assets/components/AssetFilters.tsx
  - src/app/(platform)/assets/components/AssetTablePagination.tsx
  - src/app/(platform)/assets/components/ExportAssetsButton.tsx
  - src/app/(platform)/assets/components/index.ts
  - src/components/layout/Sidebar.tsx
autonomous: true

must_haves:
  truths:
    - "Asset list page shows virtualized table of assets"
    - "Filters work for type, status, platform, genre"
    - "Pagination controls navigate between pages"
    - "CSV export includes all filtered assets"
  artifacts:
    - path: "src/app/(platform)/assets/page.tsx"
      provides: "Asset list page"
      exports: ["default"]
    - path: "src/app/(platform)/assets/components/AssetTable.tsx"
      provides: "Virtualized asset table"
      exports: ["AssetTable"]
    - path: "src/app/(platform)/assets/components/AssetFilters.tsx"
      provides: "Asset filter controls"
      exports: ["AssetFilters"]
  key_links:
    - from: "src/app/(platform)/assets/page.tsx"
      to: "src/lib/api/assets.ts"
      via: "getAssets fetch"
      pattern: "import.*getAssets"
    - from: "src/app/(platform)/assets/components/AssetTable.tsx"
      to: "src/hooks/useVirtualizedTable.tsx"
      via: "virtualization"
      pattern: "import.*useVirtualizedTable"
---

<objective>
Build the asset list page with virtualized table, filters, pagination, and CSV export.

Purpose: Staff can view and manage all submitted assets efficiently.
Output: Complete asset list page following Phase 2 user table patterns.
</objective>

<execution_context>
@/Users/sambeevors/.claude/get-shit-done/workflows/execute-plan.md
@/Users/sambeevors/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-catalog-management/CONTEXT.md
@.planning/phases/04-catalog-management/04-01-SUMMARY.md
@.planning/phases/04-catalog-management/04-03-SUMMARY.md

# Existing patterns to follow
@src/app/(platform)/users/page.tsx
@src/app/(platform)/users/components/UserTable.tsx
@src/app/(platform)/users/components/UserFilters.tsx
@src/app/(platform)/users/components/UserTablePagination.tsx
@src/app/(platform)/users/components/ExportUsersButton.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create asset list page and loading state</name>
  <files>src/app/(platform)/assets/page.tsx, src/app/(platform)/assets/loading.tsx</files>
  <action>
Create asset list page following the users/page.tsx pattern:

src/app/(platform)/assets/page.tsx:
- Server component that fetches assets based on URL searchParams
- Extract filters: type, status, platform, genre, query, page, limit
- Call getAssets from lib/api/assets
- Pass data to client components: AssetFilters, AssetTable, AssetTablePagination
- Include ExportAssetsButton above the table
- Layout: title "Assets", filters row, export button (right-aligned), table, pagination

Handle searchParams as per Next.js 15 async pattern (await searchParams).

Add navigation link to Sidebar.tsx under "Users":
- Icon: folder or music note icon
- Label: "Assets"
- Href: "/assets"

Create loading.tsx with TableRowSkeleton pattern from users/loading.tsx.
  </action>
  <verify>Page renders at /assets with loading skeleton</verify>
  <done>Asset list page fetches and displays paginated assets</done>
</task>

<task type="auto">
  <name>Task 2: Create asset filters component</name>
  <files>src/app/(platform)/assets/components/AssetFilters.tsx</files>
  <action>
Create filters following UserFilters pattern:

AssetFilters component with:
- Search input with "Search assets..." placeholder
- Search button to trigger search (not auto-search)
- Type dropdown: All Types, Music, SFX, Motion Graphics, LUTs, Stock Footage
- Status dropdown: All Statuses, Draft, Submitted, In Review, Published, Rejected (combine similar states)
- Platform dropdown: All Platforms, Music Vine, Uppbeat, Both
- Genre dropdown: All Genres (populate with common genres: Rock, Electronic, Cinematic, Pop, Hip Hop, etc.)

URL param behavior (same as users):
- Search button updates ?query=X
- Filter dropdowns update URL immediately on change
- Page resets to 1 when any filter changes
- Clean URLs: omit params with default values

Status filter should map display values to actual workflow states:
- "In Review" = initial_review, quality_check, platform_assignment, final_approval, review
- "Rejected" = rejected_initial, rejected_quality, rejected_final, rejected
- "Published" = published
- "Draft" = draft
- "Submitted" = submitted

Use Cadence Input and select styling (or native selects for simplicity, like users page).
  </action>
  <verify>Changing filters updates URL and page re-renders with filtered data</verify>
  <done>Asset filters support type, status, platform, genre, and search query</done>
</task>

<task type="auto">
  <name>Task 3: Create virtualized asset table and pagination</name>
  <files>src/app/(platform)/assets/components/AssetTable.tsx, src/app/(platform)/assets/components/AssetTablePagination.tsx, src/app/(platform)/assets/components/ExportAssetsButton.tsx, src/app/(platform)/assets/components/index.ts</files>
  <action>
Create AssetTable following UserTable pattern with virtualization:

Columns:
1. Asset (thumbnail placeholder + title) - width: 300px
2. Type (badge: Music, SFX, etc.) - width: 120px
3. Contributor (name) - width: 150px
4. Status (colored badge based on workflow state) - width: 120px
5. Platform (badge: MV, UB, Both) - width: 100px
6. Updated (relative time) - width: 120px
7. Actions (dropdown menu) - width: 80px

Use virtualization from useVirtualizedTable hook.
Row height: 72px (same as users).
Container height: 600px.

Row click navigates to /assets/[id].
Keyboard navigation via useTableKeyboard.
Empty state with NoResultsEmptyState when no data.

Actions dropdown:
- View Details (navigates to detail page)
- Unpublish (only for published assets)

AssetTablePagination: Copy UserTablePagination pattern with page size selector (25/50/100).

ExportAssetsButton: Copy ExportUsersButton pattern.
- Export columns: ID, Title, Type, Contributor, Status, Platform, Genre, Created, Updated
- Filename: assets-export-{timestamp}.csv

Create index.ts to export all components.
  </action>
  <verify>Table renders virtualized rows with proper column alignment</verify>
  <done>Asset table virtualized with keyboard navigation and row actions</done>
</task>

</tasks>

<verification>
1. /assets page loads with paginated data
2. Type filter shows only assets of selected type
3. Status filter correctly maps display values to workflow states
4. Search finds assets by title
5. Pagination shows correct page count
6. CSV export includes filtered data
7. Keyboard navigation (j/k) works in table
</verification>

<success_criteria>
- Virtualized table renders 500+ assets smoothly
- Filters combine correctly (type AND status AND platform)
- URL reflects current filter state (shareable)
- Row click navigates to detail page
- All workflow actions require navigation to detail page (manual checklist review per user decision)
</success_criteria>

<output>
After completion, create `.planning/phases/04-catalog-management/04-07-SUMMARY.md`
</output>
